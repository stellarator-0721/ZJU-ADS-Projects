# 项目三：栅栏布局恢复算法 (Recover the Design)

## 项目简介

本项目实现了浙江大学程序设计课程项目"栅栏设计恢复"问题。给定一个 \(n \times m\) 网格中连接器度数的部分信息，需要恢复完整的花园栅栏布局。每个单元格可能包含一个度数为 \(k\) ( \(1 \leq k \leq 4\) )的连接器，表示在该点连接的栅栏段数量。目标是确定所有栅栏段的具体布局，满足所有度数约束，栅栏段为直线，且没有无连接器的交叉点。

## 主要功能

### 1. 核心算法
- **完整搜索策略**：系统性的回溯搜索，保证找到解（如果存在）
- **高效剪枝和MRV**：最小剩余值启发式减少分支因子
- **几何一致性检查**：实时检测栅栏段交叉冲突
- **约束传播机制**：前向检查约束满足情况

### 2. 约束满足
- **度数约束**：确保每个连接器连接的栅栏段数量正确
- **几何约束**：防止栅栏段在不连接点交叉
- **直线段约束**：所有栅栏段必须是直线

### 3. 搜索优化
- **MRV启发式**：选择约束最强的节点优先处理
- **冲突检测**：早期检测无效路径，避免无效搜索
- **组合枚举**：对可能的栅栏段组合进行系统枚举

## 先决条件

### 1. 编译环境
- **GCC编译器**（支持C99标准）
- **Make工具**（用于自动化构建）

### 2. 运行环境
- Linux/Unix 或 Windows（MinGW环境）
- 足够的内存空间（处理大型网格时）

### 3. 目录结构要求
```
Project3/
├── bin/                    # 可执行文件目录
│   └── recover_design.exe
├── data/                   # 输入数据目录
│   ├── maximum1_in.txt
│   ├── maximum2_in.txt
│   ├── minimum1_in.txt
│   ├── minimum2_in.txt
│   ├── sample1_in.txt
│   ├── sample2_in.txt
│   └── sample3_in.txt
├── include/                # 头文件目录
│   └── recover_design.h
├── result/                 # 输出结果目录
│   └── (对应输出文件)
├── src/                    # 源代码目录
│   └── recover_design.c
└── Makefile               # 构建配置文件
```

## 使用方法

### 1. 编译项目
在项目根目录运行：
```bash
make
```

这将生成可执行文件 `bin/recover_design.exe`。

### 2. 运行程序
```bash
./bin/recover_design.exe
```

程序将从 `data/` 目录读取输入文件，并将结果输出到 `result/` 目录。

### 3. 输入文件格式
每个输入文件包含以下内容：
```
n m
d_11 d_12 ... d_1m
d_21 d_22 ... d_2m
...
d_n1 d_n2 ... d_nm
```

**参数说明**：
- `n`：网格行数
- `m`：网格列数
- `d_ij`：第 i 行第 j 列连接器的度数（0-4，0表示没有连接器）

### 4. 输出文件格式
程序为每个输入文件生成对应的输出文件，格式为：
```
网格布局
```
其中：
- 使用 `-` 表示水平栅栏段
- 使用 `|` 表示垂直栅栏段
- 使用 `+` 表示交叉点（连接器）
- 使用空格表示空白位置

